<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<link rel="stylesheet" href="css/jquery.mobile-1.3.1.min.css" />
<link rel="stylesheet" href="css/style.css" />
<script src="js/jquery-1.9.1.min.js"></script>
<script src="js/jquery.mobile-1.3.1.min.js"></script>

</head>
<body>

	<div id="resultPage" data-role="page" data-theme="c" data-content-theme="c">
		
		<div data-role="panel" id="menuDiv"  data-animate="true">
			<!-- panel content goes here -->
			<ul data-role='listview' data-icon="false">
				<li data-theme='a'>Drakfestivalen meny</li>
				<li><a href="index.html" >Start</a></li>
				<li><a href="program.html" >Program</a></li>
				<li><a href="drakkampen_startlista.html" >Startlista</a></li>
				<li><a href="drakkampen_resultat.html" >Resultat</a></li>
				<li><a href="laglista.html" >Lag</a></li>
				<li><a href="artistlista.html" >Artister</a></li>
				<li><a href="info.html" >Information</a></li>
			</ul>
		</div>
		<!-- /panel -->
		
		<div data-role="header">
			<img src="img/df_logo.jpg" width="100%" height=""/>
			<div data-role="navbar">
				<ul>
					<li style="width: 20%"><a href="#menuDiv" data-role="button" data-icon="bars" data-iconpos="notext" data-inline="true"></a></li>
					<li style="width: 80%"><a href="#"></a></li>
				</ul>
			</div>
			
		</div>
		<!-- /header -->

		<div data-role="content" >
			<!-- <a data-role="button" data-theme="c" data-icon="arrow-l" href="#" data-rel="back" data-inline="true">Tillbaka</a> -->
		
			<div data-role="navbar" data-grid="c">
			    <ul>
			        <li><a href="#" id="resultatBtn" data-role="button" class="ui-btn-active">Resultat</a></li>
			        <li><a href="#" id="top10Btn" data-role="button">Top 10</a></li>
			    </ul>
		    </div>
			
			<div id="result" >
				<h5>Resultat</h5> 
				
			</div>
			
			<div id="top10" >
				<h5>Top 10</h5>
			
			</div>	

		</div>

		<script>
		
		
		
		$( "#resultPage" ).on( "pagebeforecreate", function( event ) {
			
			
			
			$("#top10").hide();
			$("#result").show();
			
			$("#resultatBtn").click(function(){
			  $("#result").show();
			  $("#top10").hide();
			});
			
			$("#top10Btn").click(function(){
				$("#result").hide();
			 	$("#top10").show();
			});
			
			pushToList();
			pushToListTop10();
		});
		
		
		
		var serviceURL = "http://tagquiz.mathiasberg.se/df/";
		var resultArr;
		var top10Arr;
		var mainloaded = false;

		//id , namn , beskrivning
		var resultObj1 =  {"id":"1","heat":"1", "namn":"Capgemini","tid":"01:20:43","heattypid":"UTMANINGEN"};
		var resultObj2 =  {"id":"2","heat":"1", "namn":"Sogeti","tid":"01:30:05","heattypid":"UTMANINGEN"};
		var resultObj3 =  {"id":"3","heat":"1", "namn":"Softtronic","tid":"01:50:20","heattypid":"UTMANINGEN"};
		var resultObj4 =  {"id":"4","heat":"2", "namn":"Lag a","tid":"01:20:43","heattypid":"UTMANINGEN"};
		var resultObj5 =  {"id":"5","heat":"2", "namn":"Lag b","tid":"01:10:43","heattypid":"UTMANINGEN"};
		var resultObj6 =  {"id":"6","heat":"2", "namn":"Lag c","tid":"01:30:43","heattypid":"UTMANINGEN"};
		
		var top10Obj1 =  {"id":"1","heat":"1", "namn":"Capgemini","tid":"01:20:43","heattypid":"UTMANINGEN"};
		var top10Obj2 =  {"id":"2","heat":"1", "namn":"Sogeti","tid":"01:30:05","heattypid":"UTMANINGEN"};
		var top10Obj3 =  {"id":"3","heat":"1", "namn":"Softtronic","tid":"01:50:20","heattypid":"UTMANINGEN"};
		var top10Obj4 =  {"id":"4","heat":"2", "namn":"Lag a","tid":"01:20:59","heattypid":"UTMANINGEN"};
		var top10Obj5 =  {"id":"5","heat":"2", "namn":"Lag b","tid":"01:10:43","heattypid":"UTMANINGEN"};
		var top10Obj6 =  {"id":"6","heat":"2", "namn":"Lag c","tid":"02:30:43","heattypid":"UTMANINGEN"};
		
		resultArr = [resultObj1, resultObj2, resultObj3, resultObj4, resultObj5, resultObj6];
		top10Arr = [top10Obj5, top10Obj1, top10Obj4, top10Obj2, top10Obj3, top10Obj6];
		//Start loading spinner. sets to hide when ajax is finished
		//Triggered on the "toPage" after the transition animation has completed.
		//see http://jquerymobile.com/demos/1.2.1/docs/api/events.html

		$('#resultPage').on('pageshow', function(event) { //Workaround to show page loading on initial page load
			console.log('pageshow');
			
			if (!mainloaded) {
				$.mobile.loading('show');
			}

		});

		
		//Triggered on the page being initialized, after initialization occurs. Dokument is ready
		$('#resultPage').bind('pageinit', function(event) {
			console.log('pageinit');
			//ajaxCall();
			
			//pushToList();
		});

		//Ajax call. populate program list
		function ajaxCall() {
			console.log('ajaxCallPrograms');
			$.getJSON(serviceURL + 'teamlist.php', function(data) {
				proglist = data;
				mainloaded = true;
				$.mobile.loading('hide');
				//populerar li element
				pushToList();
			});
		}

		//Populate the li list element
		function pushToList() {
			console.log('pushToList');
			
			var prevHeat = "";
			$.each(resultArr,
					function(index, result) {
						var heat = result.heat;
						var heatName = "";
						if(heat != prevHeat){
							console.log("Ny heat ");
							heatName = "Heat " + heat;
						}
						//skapa ny div grid-b
						//skapa nya div block-a, block-b, block-c
						var $divGridEl = $('<div class="ui-grid-b">');
						var $divBlockAEl = $('<div class="ui-block-a">');
						var $divBarAEl = $('<div class="ui-bar">');
						
						$divGridEl.append($divBlockAEl);
						$divBlockAEl.append($divBarAEl);
						$divBarAEl.html(heatName);
						
						var $divBlockBEl = $('<div class="ui-block-b">');
						var $divBarBEl = $('<div class="ui-bar">');
						
						$divGridEl.append($divBlockBEl);
						$divBlockBEl.append($divBarBEl);
						$divBarBEl.html(result.namn);
						
						var $divBlockCEl = $('<div class="ui-block-c">');
						var $divBarCEl = $('<div class="ui-bar">');
						
						$divGridEl.append($divBlockCEl);
						$divBlockCEl.append($divBarCEl);
						$divBarCEl.html(result.tid);
						
						$('#result').append($divGridEl);
						console.log("div " + $divGridEl);
						
						prevHeat = heat;
						console.log("prevHeat " + prevHeat);
					});
			$.mobile.loading('hide');
			mainloaded = true;
			
		}
		
		
		//Populate the li list element
		function pushToListTop10() {
			console.log('pushToList top10');
			
			var prevHeat = "";
			$.each(top10Arr,
					function(index, result) {
						var heat = result.heat;
						var heatName = "";
						if(heat != prevHeat){
							console.log("Ny heat ");
							heatName = "Heat " + heat;
						}
						//skapa ny div grid-b
						//skapa nya div block-a, block-b, block-c
						var $divGridEl = $('<div class="ui-grid-b">');
						var $divBlockAEl = $('<div class="ui-block-a">');
						var $divBarAEl = $('<div class="ui-bar">');
						
						$divGridEl.append($divBlockAEl);
						$divBlockAEl.append($divBarAEl);
						$divBarAEl.html(result.namn);
						
						var $divBlockBEl = $('<div class="ui-block-b">');
						var $divBarBEl = $('<div class="ui-bar">');
						
						$divGridEl.append($divBlockBEl);
						$divBlockBEl.append($divBarBEl);
						$divBarBEl.html(result.tid);
						
						$('#top10').append($divGridEl);
						
						prevHeat = heat;
						console.log("prevHeat " + prevHeat);
					});
			$.mobile.loading('hide');
			mainloaded = true;
			
		}
		
		</script>

		<!-- 
		<div data-role="footer">
			<h4>Page Footer</h4>
		</div>
		 -->
		<!-- /footer -->
		
		
	</div>
	<!-- /page -->
	
</body>
</html>